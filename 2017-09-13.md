# ES6ä¸­çš„å¸¸ç”¨ç‰¹æ€§å’Œé‚£äº›ä¸å¸¸ç”¨ä½†å¯èƒ½ä¼šéå¸¸æœ‰ç”¨çš„ç‰¹æ€§(Part 1)

## å†™åœ¨å‰é¢ï¼š
å»å¹´åˆšè¿›è¿™å®¶å…¬å¸åå°±å‚ä¸å¯åŠ¨äº†DMPï¼ˆData-Management Platformï¼‰é¡¹ç›®ï¼Œé¡¹ç›®ä»ä¸€å¼€å§‹å°±ç”¨çš„æœ€æ–°çš„æŠ€æœ¯ï¼Œæˆ‘ä¹Ÿæ˜¯ä»é‚£æ—¶èµ·å¼€å§‹å¤§é‡æ¥è§¦ES6çš„è¯­æ³•ï¼Œåˆ°ç›®å‰ä¸ºæ­¢å·²ç»ä¸€å¹´å¤šäº†ã€‚æˆ‘å‘ç°ES6é‡Œçš„å¾ˆå¤šè¯­æ³•å·²ç»å®Œå…¨å–ä»£äº†è€å¼çš„è¯­æ³•ï¼ˆæ¯”å¦‚æœ‰äº†constå’Œletåå°±ä¸ä¼šå†ç”¨varï¼ŒPromiseå’Œasync/awaitå®Œå…¨å–ä»£äº†å›è°ƒå‡½æ•°ï¼‰ï¼Œç„¶è€Œè¿˜æœ‰ä¸€äº›ç‰¹æ€§ï¼Œä¼¼ä¹å®Œå…¨æ²¡æœ‰ç”¨åˆ°ã€‚å†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„ï¼Œå°±æ˜¯ä¸ºäº†ç ”ç©¶ä¸€ä¸‹ES6é‡Œé‚£äº›å¹³æ—¶ä¸æ€ä¹ˆç”¨çš„è¯­æ³•ï¼Œæ˜¯ä¸æ˜¯æœ‰å¯èƒ½åœ¨å®é™…ç”Ÿäº§ä¸­ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚

## Part 1: å¸¸ç”¨ç‰¹æ€§

1. const, let 
  åœ¨åªèƒ½ç”¨varæ¥å£°æ˜å˜é‡çš„æ—¶ä»£ï¼ŒJavaScriptæ˜¯æ²¡æœ‰**å—ä½œç”¨åŸŸ**çš„ï¼Œå¯¹äºæ–°æ‰‹æ¥è¯´ï¼Œç”¨varæ¥å£°æ˜å˜é‡æœ€å¸¸è§çš„æ˜¯è¿™ä¸ªé—®é¢˜ï¼š
```javascript
var a = []
for (var i = 0; i < 10; i++) {
  a[i] = function () {
    return i
  }
}
a[5]() // æœŸæœ›çš„è¿”å›å€¼æ˜¯5ï¼Œå®é™…è¿”å›10

```
å‡ºç°è¿™ç§æƒ…å†µï¼Œæ˜¯ç”±äºåœ¨**for**å¾ªç¯é‡Œå£°æ˜çš„**i**å…¶å®æ˜¯ä¸€ä¸ª**å…¨å±€å˜é‡**ï¼Œæ•°ç»„é‡Œçš„æ¯ä¸ªå‡½æ•°éƒ½å¼•ç”¨äº†è¿™ä¸ªå˜é‡**i**ï¼Œç”±äº**i**æœ€åçš„å€¼ä¸º10ï¼Œæ‰€ä»¥ä¸ç®¡ä½ æ‰§è¡Œçš„æ˜¯é‚£ä¸ªå‡½æ•°ï¼Œæœ€åéƒ½ä¼šè¿”å›10ã€‚ 

å¦‚æœç”¨**let**å°±èƒ½é¿å…è¿™ä¸ªé—®é¢˜
```javascript
let a = []
for(let i = 0; i < 10; i++) {
  a[i] = function () {
    return i
  }
}
a[5]()  // ä¸æœŸæœ›ä¸€è‡´ï¼Œè¿”å›å€¼æ˜¯5
```
é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œåœ¨**let**è¿˜æ²¡æœ‰å‡ºç°ä¹‹å‰ï¼Œå¼€å‘è€…æ˜¯å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜çš„å‘¢ï¼Ÿ
å¯ä»¥ç”¨ç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼ˆIIFEï¼‰:
```javascript
for(var i = 0; i < 10; i++) {
  a[i] = (function (x) {
    return function () {
      return x
    }
  })(i)
}
```
è¿™æ ·ä¸ºä»€ä¹ˆè¡Œä¹‹æœ‰æ•ˆï¼Œè¯·å‚çœ‹ã€Šä½ ä¸çŸ¥é“çš„JS å·1ã€‹

ä½¿ç”¨**let**è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä»£ç å—å†…JSå¼•æ“ä¸ä¼šåƒå¯¹å¾…**var**é‚£æ ·æŠŠå£°æ˜æå‡ï¼Œä¹Ÿå°±æ˜¯è¯´å£°æ˜å¿…é¡»æ”¾åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œå¦åˆ™ä¼šæŠ›å‡º**Uncaught ReferenceError**çš„é”™è¯¯ã€‚



å…³é”®å­—**const**åˆ™ç”¨äºå¸¸é‡çš„å£°æ˜ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œconståªå¯¹åŸºæœ¬ç±»å‹ç®¡ç”¨ï¼Œå¯¹äºå¯¹è±¡è¿™ç§å°±èµ·ä¸åˆ°çº¦æŸä½œç”¨äº†ï¼Œæ¯”å¦‚
```javascript
const foo = { bar: 1 }
foo.bar = 2
console.log(foo) // { bar: 2 }
```
åŸå› æ˜¯constæœ¬è´¨ä¸Šåªçº¦æŸå˜é‡æ‰€æŒ‡å‘çš„å†…å­˜åœ°å€ä¸å˜ï¼Œå¯¹äºåŸºæœ¬ç±»å‹ï¼Œå€¼å°±ä¿å­˜åœ¨å˜é‡æŒ‡å‘çš„å†…å­˜åœ°å€ã€‚


2. å‡½æ•°å‚æ•°é»˜è®¤å€¼
  è¿™ä¸ªä¸å¿…å¤šè¯´ï¼Œè‡ªä»ç”¨ä¸Šäº†è¿™ä¸ªç‰¹æ€§ï¼Œå°‘å†™äº†å¾ˆå¤šä»£ç ï¼Œå…ˆçœ‹ES6æ€ä¹ˆå†™
```javascript
function printX(x = 'x') {
  console.log(x)
}
printX() // x
printX('y')  // y
```
ç”¨æ³•ä¸€ç›®äº†ç„¶ã€‚
å†æ¥å¯¹æ¯”ä¸€ä¸‹è¿‡å»çš„å†™æ³•ï¼š
```javascript
function printX(x) {
  x = x || 'x'
  console.log(x)
}
```
è¿™è¿˜åªæ˜¯ä¸€ä¸ªå‚æ•°çš„æƒ…å†µï¼Œå¤šä¸ªå‚æ•°çš„æƒ…å†µä¸‹æ›´èƒ½ä½“ç°**å‡½æ•°å‚æ•°é»˜è®¤å€¼**çš„ä½œç”¨ã€‚

3. ç®­å¤´å‡½æ•°
  ç®­å¤´å‡½æ•°çš„æ„ä¹‰ï¼Œä¸åªæ˜¯å†™æ³•æ›´åŠ ä¼˜é›…ã€‚
```javascript
// ç®­å¤´å‡½æ•°
var f = v => v
// è€å¼çš„å†™æ³•
var f = function (v) {
  return v
}
```
å¤šä¸ªå‚æ•°
```javascript
// arrow function
var add = (num1, num2) => num1 + num2
// old style
var add = function (num1, num2) {
  return num1 + num2
}
```
ç®€æ´äº†ä¸æ­¢ä¸€ä¸¢ä¸¢ã€‚

é™¤äº†å†™æ³•æ›´è‹±ä¿Šæ½‡æ´’ï¼Œè¿˜æœ‰**æœ€å…³é”®**çš„ä¸€ç‚¹åŒºåˆ«ï¼Œå°±æ˜¯äºŒè€…å¯¹**this**çš„å¤„ç†æ–¹å¼ï¼Œä»¥ä¸‹é¢è¿™ä¸ªä¾‹å­æ¥è¯´ï¼š
```javascript
var a = 'foo'
function foo () {
  setTimeout(function () {
    console.log(this.a)
  }, 1000)
}
// é»˜è®¤thisç»‘å®š
foo() // foo
// éšå¼thisç»‘å®š
var obj = {
  a: 'bar',
  foo: foo
}
obj.foo() // foo
// æ˜¾å¼thisç»‘å®š
foo.apply({ a: 'whatever' }) // foo
```
å¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºä½•ç§æ–¹å¼ï¼Œæ§åˆ¶å°è¾“å‡ºå§‹ç»ˆæ˜¯'foo'ï¼Œä¹Ÿå°±æ˜¯åœ¨ä¸€å¼€å§‹å£°æ˜çš„å…¨å±€å˜é‡**a**ï¼Œè¯´æ˜**setTimeout**é‡Œçš„å‡½æ•°åœ¨æ‰§è¡Œæ—¶**this**æŒ‡å‘å…¨å±€å¯¹è±¡windowï¼ˆæµè§ˆå™¨ç¯å¢ƒä¸‹ï¼‰ã€‚
å¦‚æœæŠŠsetTimeouté‡Œçš„å‡½æ•°æ¢æˆç®­å¤´å‡½æ•°ï¼Œå†çœ‹çœ‹ç»“æœ
```javascript
var a = 'foo'
function foo () {  
  setTimeout(() => {
    console.log(this.a)
  }, 1000)
}
foo() // foo
var obj = {
  a: 'bar',
  foo: foo
}
obj.foo()  // bar
foo.apply({ a: 'whatever' }) // whatever
```
äº§ç”Ÿå·®å¼‚çš„åŸå› åœ¨äºï¼Œç®­å¤´å‡½æ•°é‡Œçš„this**æ€»æ˜¯**æŒ‡å‘å®šä¹‰æ—¶çš„ä¸Šä¸‹æ–‡ï¼Œè€Œä¸æ˜¯å‡½æ•°æ‰§è¡Œæ—¶çš„ä¸Šä¸‹æ–‡ã€‚


4. å¯¹è±¡å±•å¼€ç¬¦(...)å’Œå±æ€§ç®€å†™ 
  è¿™ä¸¤ä¸ªç‰¹æ€§æˆ‘ä¸ªäººéå¸¸å–œæ¬¢ï¼Œå¯¹è±¡å±•å¼€ç¬¦å¯ä»¥ç”¨åœ¨è®¸å¤šåœ°æ–¹
```javascript
let foo = {
  a: 1,
  b: 2,
  c: 3
}
// Example 0
// ä»¥ä¸‹ä¸¤ç§æ–¹å¼æ•ˆæœç›¸åŒ
let bar = {...foo, d: 4}  // {a: 1, b: 2, c: 3, d: 4}
let baz = Object.assign({}, foo, { d: 4 })  // {a: 1, b: 2, c: 3, d: 4}
// Example 1
let { a, ...rest } = foo  // a => 1, rest => {b: 2, c: 3}
// Example 2
let fun = function (a, b, c) {
  return a + b + c
}
let args = [a, b, c]
fun.apply(null, args) // ä¸ç”¨å±•å¼€ç¬¦å°±åªèƒ½ç”¨applyæ¥ä¼ é€’å‚æ•°
fun(...args)  // æœ‰äº†å±•å¼€ç¬¦å°±ä¸éœ€è¦applyæ¥å¸®è¡¬
```

å¯¹è±¡å±æ€§ç®€å†™ä¹Ÿå¾ˆæœ‰ç”¨ï¼š
```javascript
let foo = 'foo'
let bar = 'bar'

let obj = {
  foo,
  bar
}
```
å¾ˆæ˜¾ç„¶ï¼Œå£°æ˜å¯¹è±¡æ—¶å½“keyå’Œvalueç›¸åŒæ—¶ï¼Œå¯ä»¥åªå†™keyè€Œçœç•¥valueéƒ¨åˆ†ã€‚

5. async/await
  å…³äºasync/awaitï¼Œæœ‰å¿…è¦å•ç‹¬å†™ä¸€ç¯‡æ€»ç»“ï¼Œè¿™é‡Œå…ˆç»™è‡ªå·±æŒ–ä¸ªå‘ã€‚

6. æ–°å¢å†…ç½®å‡½æ•°
  ES6 åœ¨Stringï¼ŒNumberï¼ŒArrayï¼ŒObjectè¿™äº›åŸç”Ÿå¯¹è±¡ä¸Šæ–°å¢äº†å¾ˆå¤šå®ç”¨æ–¹æ³•ï¼Œå¯¹äºåƒlodash/underscoreè¿™ç±»çš„ç±»åº“ä¾èµ–å˜å°äº†å¾ˆå¤šã€‚
#### String
includes, startsWith, endsWith, repeat, padStart, padEnd...
æ¯ä¸ªå‡½æ•°åŸºæœ¬ä¸Šçœ‹åå­—å°±çŸ¥é“æ˜¯å¹²å•¥çš„äº†ã€‚
```javascript
let name = 'wangweitao'
name.includes('wei') // true
name.startsWith('wang') // true
name.endsWith('ao') // true
name.repeat(2) // wangweitaowangweitao
// padStart, endStartçš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šå­—ç¬¦ä¸²é•¿åº¦ï¼Œå½“ç»™å®šå­—ç¬¦ä¸²å°äºè¿™ä¸ªé•¿åº¦æ—¶ï¼Œç”¨ç¬¬äºŒä¸ªå‚æ•°æ¥è¡¥é½
name.padStart(12, 'x') // xxwangweitao
name.padEnd(12, 'x')  // wangweitaoxx
```

#### Number
parseInt, parseFloat, isInteger, isNaN, EPSILON, \*\*(Math.pow)...
parseInt, parseFloatä¹‹å‰æ˜¯å…¨å±€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ï¼ŒES6ä»¥åç§»æ¤åˆ°Numberå¯¹è±¡ä¸Šï¼Œå› æ­¤**ä¸å†æ˜¯**å…¨å±€çš„ã€‚
```javascript
Number.isInteger(3) // true
Number.isInteger(3.0) // true
Number.isInteger(3.3)  // false

Number.isNaN(NaN)  // è¿™ä¸ªæ–¹æ³•è§£å†³äº†JSé‡ŒNaN == NaNä¸ºfalseçš„é—®é¢˜
```
Number.EPSILONè¡¨ç¤ºä¸€ä¸ªæå°å¸¸é‡ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œç”±äºæµ®ç‚¹æ•°çš„ç²¾åº¦é—®é¢˜ï¼Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­ 0.1 + 0.2 æ˜¯ä¸ç­‰äº0.3çš„ï¼ˆåœ¨JSä¸­ç­‰äº0.30000000000000004ï¼‰ï¼ŒNumber.EPSILONåœ¨åˆ¤æ–­æµ®ç‚¹æ•°æ˜¯å¦ç›¸ç­‰æ—¶ä½œç”¨å°±ä½“ç°å‡ºæ¥äº†
```javascript
0.1 + 0.2 === 0.3  // false
(0.1 + 0.2) - 0.3 < Number.EPSILON  // true
0.3 - (0.1+ 0.2) < Number.EPSILON  // true
```

#### Array
  è¿™é‡Œåˆ—ä¸¾ä¸€äº›å¯ä»¥å–ä»£**lodash**çš„åŸç”Ÿå‡½æ•°ï¼Œä¸ä¸€å®šæ˜¯ES6ä¸­æ‰å‡ºç°çš„ã€‚
  ```javascript
  let arr = new Array(5)
  // å–ä»£ _.fill
  arr.fill(0) //  [0, 0, 0, 0, 0] 
  // å–ä»£ _.some ç”¨æ¥æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦åŒ…å«ç¬¦åˆæ¡ä»¶çš„å…ƒç´ 
  arr.some(el => el === 1) // false  
  // å–ä»£ _.every ç”¨æ¥æ£€æŸ¥æ•°ç»„ä¸­å…ƒç´ æ˜¯å¦å…¨éƒ¨ç¬¦åˆç»™å®šæ¡ä»¶
  arr.every(el => el === 0) // true
  // å–ä»£ _.forEach
  let another_arr = []
  arr.forEach((el, idx) => { another_arr[idx] = el + idx }) // [0, 1, 2, 3, 4]
  // å–ä»£ _.map
  let third_arr = []
  third_arr = arr.map((el, idx) => el + idx) // [0, 1, 2, 3, 4]
  // å–ä»£ _.reduce
  third_arr.reduce((accu, curr) => accu + curr, 0) // 10
  // Array.from
  let fourth_arr = Array.from(third_arr) // Array.fromä¼šåŸºäºæ‰€ç»™å‚æ•°(å­—ç¬¦ä¸²ï¼Œæ•°ç»„æˆ–è€…Array-likeçš„å¯¹è±¡)åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„
  ```

#### Object
  å®é™…ç”Ÿäº§ä¸­ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„è«è¿‡äº **Object.assign** äº†ï¼Œ
  åœºæ™¯1: å¯¹è±¡å¤åˆ¶
  ```javascript
  let name = { last_name: 'wang', first_name: 'weitao' }
  let copy = Object.assign({}, name)
  ```
  è¿™é‡Œè¦æ³¨æ„ä¸€ç‚¹ï¼ŒObject.assignçš„å¤åˆ¶æ˜¯**æµ…å¤åˆ¶**ï¼Œå¦‚æœå¯¹è±¡ä¸­åŒ…å«å¼•ç”¨ï¼Œåˆ™åŸæ¥çš„å¯¹è±¡å’Œå¤åˆ¶çš„å¯¹è±¡æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¼•ç”¨ã€‚

  åœºæ™¯2: åœ¨ä¸æ”¹å˜åŸæœ‰å¯¹è±¡çš„æƒ…å†µä¸‹ç»™å¯¹è±¡é™„åŠ å±æ€§
  ```javascript
  let name = { last_name: 'wang', first_name: 'weitao' }
  let person = Object.assign({}, name, { age: 23 })  // {last_name: "wang", first_name: "weitao", age: 23} 
  ```
  ä½†æ˜¯ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼Œç›´æ¥åœ¨åŸæœ‰å¯¹è±¡ä¸Šèµ‹å€¼ä¸æ˜¯æ›´ç®€å•å—ã€‚è¦è§£ç­”è¿™ä¸ªé—®é¢˜ï¼Œ å°±ä¸å¾—ä¸æåˆ°[Redux](https://github.com/reactjs/redux)è¿™ä¸ªå·¥å…·ï¼Œæˆ‘ä»¬ç”¨Reduxæ¥å¸®åŠ©ç®¡ç†Appçš„çŠ¶æ€ï¼ŒReduxæŠŠAppçš„çŠ¶æ€å­˜åœ¨ä¸€ä¸ªå•ä¸€å¯¹è±¡é‡Œï¼Œå› æ­¤æ¯æ¬¡çŠ¶æ€æ”¹å˜ï¼Œè¿™ä¸ªå¯¹è±¡ä¹Ÿä¼šç›¸åº”æ”¹å˜ï¼Œä½†æ˜¯å®é™…ä¸Šæ‰¿è½½**ä¸Šä¸€ä¸ª**çŠ¶æ€çš„å¯¹è±¡å¹¶ä¸ä¼šæ”¹å˜ï¼ˆå¬èµ·æ¥å¯èƒ½æœ‰ç‚¹æ™•ï¼‰ï¼ŒçŠ¶æ€æ”¹å˜ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å¯¹è±¡æ¥æ‰¿è½½å½“å‰æœ€æ–°çš„çŠ¶æ€ï¼Œè¿™æ ·åšçš„å¥½å¤„ä¹‹ä¸€å°±æ˜¯ä½¿çŠ¶æ€å˜å¾—èƒ½å¤Ÿ**å›æº¯**ã€‚å…¶ä¸­æœ‰ä¸€ç‚¹å‡½æ•°å¼ç¼–ç¨‹çš„æ„æ€ï¼Œå‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œå‡½æ•°ä¸æ”¹å˜æ¥æ”¶çš„å‚æ•°ã€‚

## Part 2: ä¸å¸¸ç”¨ç‰¹æ€§

å‡ºäºç¯‡å¹…è€ƒè™‘ï¼Œè¿™éƒ¨åˆ†å¦èµ·äº†ä¸€ç¯‡ [æ–‡ç« ](https://github.com/weita0/blog/blob/master/2017-09-13.md)ï¼ˆğŸ‘ˆ ç‚¹è¿™é‡Œè·³è½¬ï¼‰